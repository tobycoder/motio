from sqlalchemy import inspect
from alembic import op

def _get_uc_name(table, columns: set[str]) -> str | None:
    bind = op.get_bind()
    insp = inspect(bind)
    for uc in insp.get_unique_constraints(table):
        if set(uc.get('column_names', [])) == columns:
            return uc.get('name')
    return None

def upgrade():
    # voorbeeld: unieke constraint op kolom 'titel' zoeken en droppen
    uc_name = _get_uc_name('amendementen', {'titel'})
    with op.batch_alter_table('amendementen') as batch_op:
        if uc_name:
            batch_op.drop_constraint(uc_name, type_='unique')
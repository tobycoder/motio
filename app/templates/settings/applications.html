{% extends 'base.html' %}
{% block content %}
<main class="mx-auto max-w-4xl px-4 py-8 sm:px-6 lg:px-8">
    <div class="mb-8">
        <h1 class="text-2xl font-semibold text-slate-900 dark:text-white">Toegang tot toepassingen</h1>
        <p class="mt-2 text-sm text-slate-600 dark:text-slate-400">
      Kies per rol welke toepassingen zichtbaar zijn binnen <strong>{{ tenant_name }}</strong>.
      Superadmins behouden altijd toegang, ongeacht deze instellingen.
    </p>
    {% if uses_global %}
    <div class="mt-3 inline-flex items-center gap-2 rounded-xl border border-blue-100 bg-blue-50/80 px-4 py-2 text-xs text-blue-700 dark:border-blue-500/30 dark:bg-blue-500/10 dark:text-blue-200">
      <i class="fa-solid fa-globe"></i>
      <span>Geen tenant actief: deze instellingen gelden globaal voor alle gebruikers.</span>
    </div>
    {% endif %}
  </div>

  <form method="post" class="space-y-6">
    <div class="overflow-hidden rounded-2xl border border-slate-200/70 bg-white shadow-sm dark:border-slate-700 dark:bg-slate-900/70">
      <table class="min-w-full divide-y divide-slate-200 text-sm dark:divide-slate-700">
        <thead class="bg-slate-50 dark:bg-slate-900/60">
          <tr>
            <th scope="col" class="px-6 py-3 text-left font-semibold text-slate-600 dark:text-slate-300">Toepassing</th>
            {% for role in manageable_roles %}
            <th scope="col" class="px-6 py-3 text-center font-semibold text-slate-600 dark:text-slate-300 capitalize">{{ role }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody class="divide-y divide-slate-200 bg-white dark:divide-slate-700 dark:bg-slate-900/50">
          {% for app in applications %}
          <tr>
            <td class="px-6 py-4 align-top">
              <div class="font-semibold text-slate-900 dark:text-white">{{ app.title }}</div>
              <p class="mt-1 text-xs text-slate-500 dark:text-slate-400">{{ app.description }}</p>
            </td>
            {% for role in manageable_roles %}
            <td class="px-6 py-4 text-center align-middle">
              <label class="inline-flex items-center justify-center gap-2">
                <input
                  type="checkbox"
                  name="roles_{{ app.slug }}"
                  value="{{ role }}"
                  class="h-4 w-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500"
                  {% if role in app.selected %}checked{% endif %}>
                <span class="sr-only">{{ role }}</span>
              </label>
            </td>
            {% endfor %}
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="flex items-center justify-end gap-3">
      <a href="{{ url_for('gebruikers.settings') }}" class="inline-flex items-center gap-2 rounded-xl border border-slate-200 px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-50 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800">
        Annuleren
      </a>
      <button type="submit" class="inline-flex items-center gap-2 rounded-xl bg-emerald-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2">
        Toegang opslaan
      </button>
    </div>
  </form>
</main>
{% endblock %}
